<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>OfficeJs - Meshesha</title>
    <!--All-->
    <script src="./jQuery/jquery-1.12.4.min.js"></script>
	 <link rel="stylesheet" href="./include/jquery_ui/themes/start/jquery-ui.min.css">
    <script src="./include/jquery_ui/jquery-ui.min.js"></script>
    <!--PDF-->
    <script src="./pdf/pdf.js"></script>
    <!--Docs-->
    <script src="./docxjs/jszip-utils.js"></script>
    <script src="./docxjs/mammoth.browser.min.js"></script>
    <!--PPTX-->
    <link rel="stylesheet" href="./pptxjs/pptxjs.css">
    <link rel="stylesheet" href="./pptxjs/nv.d3.min.css">
    <script type="text/javascript" src="./pptxjs/jszip.min.js"></script>
    <script type="text/javascript" src="./pptxjs/filereader.js"></script>
    <script type="text/javascript" src="./pptxjs/d3.min.js"></script>
    <script type="text/javascript" src="./pptxjs/nv.d3.min.js"></script>
    <script type="text/javascript" src="./pptxjs/pptxjs.js"></script>
    <script type="text/javascript" src="./pptxjs/divs2slides.js"></script>
    <script language="javascript" type="text/javascript" src="./pptxjs/core-min.js"></script>
    <script language="javascript" type="text/javascript" src="./pptxjs/enc-base64-min.js"></script>
    <!--All Spreadsheet -->
    <script type="text/javascript" src="./sheetjs/handsontable.full.min.js"></script>
    <script type="text/javascript" src="./sheetjs/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="./sheetjs/handsontable.full.min.css">
    <!--All-->
    <script src="officejs.js"></script>
	 <link rel="stylesheet" href="./include/officeToHtml/officeToHtml.css">
	 
  </head>
  <body>

    <div id="main_warper">
      <div id="header2"></div>
      <div id="header"></div>
      <div id="left_warper"></div>
      <div id="center_warper">
        <div id="resolt_content"></div>
      </div>
      <div id="right_warper"></div>
      <div id="footer"></div>
    </div>
	
    <script type="text/javascript">
    //var file_url = "Files/Hyundai Getz.docx"; 
    //var file_url = "Files/bg.jpg";
    //var file_url = "Files/pdf_demo.pdf";
    //file_url = "Files/Sample_12.pptx";
    //var file_url = "Files/sheetjs.xlsx";
    //var file_url = "Files/sheetjs.xlsx";
	 function base64_decode(source){
            try
            {
            alert("ccccccc2");
                //modified by huangwenhai on 2018-01-15 解决子页面通过parent.xx调用无法找到CryptoJS的问题
                var CryptoJS=window.CryptoJS || top.CryptoJS;
                alert(CryptoJS);
                //add end 2018-01-15 
                var words = CryptoJS.enc.Base64.parse(source);
                alert(words);
                var base64=words.toString(CryptoJS.enc.Utf8);
                alert(base64);
                return base64;
                
            }catch(e)
            {
                console.log("解码错误");
                return "";
            }
        }
 
      $(function(){
	       var httpUrl = window.location.href;
           var uL =  httpUrl.split("?");
           var fileUrl;
		    /* $("#resolt_content").append(
			$("<img/>").addClass("loadingimg").attr("src", "bg.gif")
		   )*/
           try{
		   if(uL.length >1){
		   
                fileUrl = uL[1];

                 $("#resolt_content").officejs({
                    url: fileUrl,
                  });
           }else{
                console.log("未传文件路径， 调用路径是："+ httpUrl);
           }
		   }catch(e){alert(e)}
      });
			  
			
				
					
    </script>
  </body>
</html>
